\documentclass[12pt]{article}
\usepackage[T1]{fontenc}
\usepackage[T1]{polski}
\usepackage[cp1250]{inputenc}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage[left=1.5cm, right=2cm]{geometry}
\setlength{\textheight}{21cm}

\title{{\bf Zadanie nr 2 - Wyznaczanie cech oraz badanie trendu}\linebreak
Analiza danych z≥oøonych z detekcjπ wyjπtkÛw}
\author{Karol Kazusek - 254189, Sebastian Zych - 254264}
\date{21.10.2024}

\begin{document}
\clearpage\maketitle
\thispagestyle{empty}
\newpage
\setcounter{page}{1}
\section{Cel zadania}
Zadanie polega na wyznaczeniu cech w wybranym strumieniu danych oraz wyznaczeniu
trendu. Do analiz naleøa≥o wybraÊ tematykÍ medycyny lub rozpoznawania faz ruchu aktywnoúci cz≥owieka (systemy HAR)

\section{Opis zaproponowanych KlasyfikatorÛw i algorytmÛw detekcji zmian }

\subsection{Metoda klasyfikacyjne}

\subsubsection{K-nn}

Metoda \textbf{K-Najbliøszych SπsiadÛw (K-NN)} to jedna z najprostszych technik klasyfikacji. Dzia≥a na zasadzie porÛwnywania nowego punktu danych z istniejπcymi przyk≥adami treningowymi. Algorytm wybiera \( K \) najbliøszych sπsiadÛw (na podstawie odleg≥oúci euklidesowej lub innych miar), a nastÍpnie przypisuje nowy punkt do klasy, ktÛra wystÍpuje najczÍúciej wúrÛd tych sπsiadÛw.

\begin{itemize}
    \item \texttt{n\_neighbors}: Liczba sπsiadÛw (\( K \)) do uwzglÍdnienia przy klasyfikacji.
    \item \texttt{weights}: SposÛb waøenia sπsiadÛw. Moøliwe wartoúci to \texttt{'uniform'} (wszyscy sπsiedzi majπ takπ samπ wagÍ) i \texttt{'distance'} (bliøsi sπsiedzi majπ wiÍkszy wp≥yw).
    \item \texttt{metric}: Miara odleg≥oúci uøywana do porÛwnania punktÛw, w naszym przypadku wyznaczamy odleg≥oúÊ za pomocπ metryki wyznaczonπ przez DTW oraz euklidesowπ do porÛwnania.
\end{itemize}

\subsubsection{DTW}

Metryka \textbf{Dynamic Time Warping (DTW)} to algorytm s≥uøπcy do mierzenia odleg≥oúci miÍdzy dwoma sekwencjami czasowymi, ktÛre mogπ rÛøniÊ siÍ czestotliwoúciπ, fazπ lub d≥ugoúciπ. Jego celem jest znalezienie optymalnej nieliniowej úcieøki dopasowania miÍdzy dwiema sekwencjami, minimalizujπc rÛønice miÍdzy nimi.
Algorytm wykorzystuje dynamiczne programowanie, aby efektywnie znaleüÊ najlepsze dopasowanie.


\subsubsection{TSF}
\textbf{TimeSeriesForest (TSF)} to algorytm klasyfikacji szeregÛw czasowych zaprojektowany z myúlπ o analizie i modelowaniu danych sekwencyjnych. Jest on rozwiniÍciem klasycznych metod klasyfikacji, takich jak lasy losowe, jednak dostosowany do pracy z danymi zmieniajπcymi siÍ w czasie.
TimeSeriesForest wykorzystuje koncepcjÍ lasÛw losowych, aby po≥πczyÊ wyniki z wielu drzew decyzyjnych, dziÍki czemu model osiπga wyøszπ dok≥adnoúÊ i lepszπ generalizacjÍ. W TSF kaøde drzewo jest trenowane na losowych podprÛbkach danych czasowych, a jego struktura jest dostosowana do analizy charakterystycznych cech serii czasowych.

\begin{itemize}
  \item \texttt{n\_estimators}: Liczba drzew ktÛre bÍdπ podejmowaÊ decyzjÍ o klasyfikacji wzorca.
  \item \texttt{n\_windows}: Liczba okien, z ktÛrych wyodrÍbniane sπ cechy.
  \item \texttt{min\_window\_size}: Minimalna d≥ugoúÊ okien wykorzystwyana w klasyfikacji.
\end{itemize}
\pagebreak
\subsection{Metoda detekcji zmian}

\subsubsection{ADWIN}

(Okno przesuwne) \textbf{Adaptive Windowing (ADWIN)} to metoda wykrywania concept drift, czyli zjawiska zmiany rozk≥adu danych w czasie, co moøe wp≥ywaÊ na skutecznoúÊ modeli uczπcych siÍ. 
ADWIN dzia≥a poprzez dynamiczne dostosowywanie okna czasowego, ktÛre monitoruje dane strumieniowe, starajπc siÍ zidentyfikowaÊ momenty, w ktÛrych statystyczne w≥aúciwoúci danych ulegajπ zmianie.
Kiedy wykrywana jest istotna rÛønica miÍdzy starπ a nowπ czÍúciπ okna, starsze dane sπ odrzucane, a nowe w≥πczane do analizy. DziÍki automatycznej adaptacji wielkoúci okna ADWIN skutecznie reaguje na rÛøne rodzaje i prÍdkoúci driftu, co sprawia, øe jest uøytecznym narzÍdziem w úrodowiskach strumieniowych.

\begin{itemize}
  \item \textbf{delta}:
  \begin{itemize}
    \item Typ: \texttt{float}
    \item Opis: Kontroluje poziom istotnoúci statystycznej przy wykrywaniu driftu. Niøsza wartoúÊ oznacza bardziej restrykcyjne wykrywanie zmian, wyøsza ñ czÍstsze wykrywanie.
  \end{itemize}
  
  \item \textbf{clock}:
  \begin{itemize}
    \item Typ: \texttt{int}
    \item Opis: Okreúla, co ile prÛbek algorytm sprawdza moøliwoúÊ wystπpienia driftu.
  \end{itemize}
  
  \item \textbf{min\_window\_length}:
  \begin{itemize}
    \item Typ: \texttt{int}
    \item Opis: Minimalna d≥ugoúÊ okna obserwacyjnego, chroni przed zbyt szybkim usuwaniem starszych danych.
  \end{itemize}
  
\end{itemize}
\subsubsection{DDM}
\textbf{DDM (Drift Detection Method)} to metoda wykrywania zmian koncepcyjnych oparta na modelu PAC (Probably Approximately Correct), zak≥adajπca, øe jeúli rozk≥ad danych jest stacjonarny, to wraz ze wzrostem liczby analizowanych prÛbek wskaünik b≥ÍdÛw klasyfikatora powinien siÍ zmniejszaÊ.

Jeúli algorytm wykryje wzrost wskaünika b≥ÍdÛw, ktÛry przekroczy wyznaczony prÛg, uznaje, øe nastπpi≥a zmiana lub ostrzega uøytkownika o moøliwoúci zmiany w najbliøszym czasie ñ tÍ sytuacjÍ nazywa siÍ strefπ ostrzeøenia (warning zone).

\section{Charakterystyka wybranych do danych}

\href{https://www.physionet.org/content/mitdb/1.0.0/}{MIT-BIH Arrhythmia Database} to szeroko stosowany zestaw danych wykorzystywany w badaniach dotyczπcych analizy sygna≥Ûw elektrokardiograficznych (EKG) oraz automatycznej klasyfikacji arytmii. ZbiÛr ten zawiera 48 zapisÛw sygna≥Ûw EKG zarejestrowanych u 47 pacjentÛw, w tym zarÛwno osÛb z rÛønymi typami arytmii, jak i zdrowych. Kaødy zapis obejmuje oko≥o 30 minut sygna≥u EKG, ktÛry zosta≥ pobrany w czÍstotliwoúci 125 Hz.

Dane zosta≥y rÍcznie oznakowane przez kardiologÛw, co pozwala na identyfikacjÍ rÛønych typÛw arytmii, takich jak np. skurcze dodatkowe, migotanie przedsionkÛw czy blokady serca. MIT-BIH Arrhythmia Database jest czÍsto wykorzystywany w algorytmach sztucznej inteligencji do trenowania systemÛw do automatycznej diagnozy arytmii. 
\\
Kroki uøywane do ekstrakcji uderzeÒ z sygna≥u EKG wed≥ug autorÛw DBLP:journals/corr/abs-1805-0079DBLP:journals/corr/abs-1805-007944 by≥y nastÍpujπce:
\begin{enumerate}
    \item Podzia≥ ciπg≥ego sygna≥u EKG na okna 10s i wybÛr jednego okna 10s z sygna≥u EKG.
    \item Normalizacja wartoúci amplitudy do zakresu od zera do jeden.
    \item Znalezienie zbioru wszystkich lokalnych maksimÛw na podstawie zerokrosÛw pierwszej pochodnej.
    \item Znalezienie zbioru kandydatÛw na szczyty R EKG poprzez zastosowanie progu 0.9 na znormalizowanej wartoúci lokalnych maksimÛw.
    \item Znalezienie mediany interwa≥Ûw czasowych R-R jako nominalnego okresu bicia serca dla danego okna (T).
    \item Dla kaødego szczytu R wybÛr czÍúci sygna≥u o d≥ugoúci rÛwnej 1.2T.
    \item Uzupe≥nienie kaødej wybranej czÍúci zerami, aby jej d≥ugoúÊ by≥a rÛwna zdefiniowanej sta≥ej d≥ugoúci.
\end{enumerate}

\textbf{Liczba prÛbek}: 21900  \\
\textbf{Liczba kategorii}: 5 \\
\textbf{CzÍstotliwoúÊ prÛbkowania}: 125Hz \\
\begin{tabular}{lcc}
    \textbf{Nazwa klasy} & \textbf{etykieta} & \textbf{liczebnoúÊ} \\
    \hline\hline\\[-0.4cm]
    Normalne uderzenie &  0 & 1658 \\ \hline
    Przedwczesne uderzenie nadkomorowe &  1 &  556\\ 
    Przedwczesny skurcz komorowy &  2 & 1448\\ 
    Fuzja skurczu komorowego i normalnego uderzenia &  3 & 162\\ 
    Niezdyscyplinowane uderzenie &  4 & 1608\\ 
\end{tabular}


Dane w celu trenowania klasyfikatorÛw 1-NN-DTW i 3-NN-DTW zosta≥y okrojeone do liczebnoúci 100 na kaødπ klasÍ, przez wysokie wymagania sprzÍtowe algorytmÛw.
\subsection{ZbiÛr danych wykorzystywany w Concept drift}
Jest to zbiÛr opisujπcy wygenerowany ruch siciowy, wykorzystywany jest jako zbiÛr testowy wykrywania anomali.
Zawiera w sobie informacjÍ o:
\begin{enumerate}
  \item èrÛdle i celu transmisji.
  \item Porcie ürÛd≥owym oraz celu.
  \item ProtokÛ≥.
  \item Rozmiar transmisji i iloúÊ pakietÛw.
  \item Czas trwania transmisji.
\end{enumerate}

\section{Eksperymenty i wyniki}

\subsection{Eksperyment nr 1}
\subsubsection{Za≥oøenia}
Wykonanie klasyfikatora K-nn z metrykπ DTW dla rÛønych liczby sπsiadÛw.

\subsubsection{Rezultat 1-NN-DTW i 3-NN-DTW}
\begin{table}[htbp]
\centering
\begin{tabular}{|l|c|c|c|c|}
\hline
\textbf{Classifier} & \textbf{Accuracy} & \textbf{Precision} & \textbf{Sensitivity} & \textbf{Specificity} \\ \hline
KNeighborsClassifier\_metric=DTW\_n\_neighbors=1 & 0.660 & 0.682765 & 0.660 & 0.915 \\ \hline
KNeighborsClassifier\_metric=DTW\_n\_neighbors=3 & 0.620 & 0.622787 & 0.620 & 0.905 \\ \hline
\end{tabular}
\caption{Statystki dla 1-NN-DTW i 3-NN-DTW}
\label{tab:knn_dtw_performance}
\end{table}


\begin{figure}[hp!]
    \centering
    \includegraphics[width=12.3cm]{DTW1.png}
    \vspace{-0.1cm}
    \caption{Krzywa uczenia dla 1-NN-DTW}
    \label{Krzywa uczenia dla 1-NN-DTW}
\end{figure}
\begin{figure}[htbp!]
    \centering
    \includegraphics[width=12.3cm]{DTW3.png}
    \vspace{-0.1cm}
    \caption{Macierz pomy≥ek dla 1-NN-DTW}
    \label{Macierz pomy≥ek dla 1-NN-DTW}
\end{figure}
\begin{figure}[hp!]
  \centering
  \includegraphics[width=12.3cm]{DTW2.png}
  \vspace{-0.1cm}
  \caption{Krzywa uczenia dla 3-NN-DTW}
  \label{Krzywa uczenia dla 3-NN-DTW}
\end{figure}
\begin{figure}[htbp!]
  \centering
  \includegraphics[width=12.3cm]{DTW4.png}
  \vspace{-0.1cm}
  \caption{Macierz pomy≥ek dla 3-NN-DTW}
  \label{Macierz pomy≥ek dla 3-NN-DTW}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PODROZDZIA£ PT. EKSPERYMENT NR N 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\subsubsection{Rezultat TSF}
\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|c|c|c|c|}
  \hline
  \textbf{Classifier} & \textbf{Accuracy} & \textbf{Precision} & \textbf{Sensitivity} & \textbf{Specificity} \\ \hline
  TimeSeriesForest\_n\_w=1\_min\_window\_size=1 & 0.712997 & 0.655248 & 0.601963 & 0.921563 \\ \hline
  TimeSeriesForest\_n\_w=1\_min\_window\_size=5 & 0.746870 & 0.732415 & 0.698350 & 0.930439 \\ \hline
  TimeSeriesForest\_n\_w=1\_min\_window\_size=10 & 0.736009 & 0.712384 & 0.674085 & 0.927971 \\ \hline
  TimeSeriesForest\_n\_w=5\_min\_window\_size=1 & 0.870214 & 0.845206 & 0.805423 & 0.964475 \\ \hline
  TimeSeriesForest\_n\_w=5\_min\_window\_size=5 & 0.832474 & 0.810761 & 0.775638 & 0.954112 \\ \hline
  TimeSeriesForest\_n\_w=5\_min\_window\_size=10 & 0.878314 & 0.856982 & 0.823460 & 0.966818 \\ \hline
  TimeSeriesForest\_n\_w=10\_min\_window\_size=1 & 0.856222 & 0.816359 & 0.792334 & 0.960982 \\ \hline
  TimeSeriesForest\_n\_w=10\_min\_window\_size=5 & 0.927835 & 0.904411 & 0.874825 & 0.980398 \\ \hline
  TimeSeriesForest\_n\_w=10\_min\_window\_size=10 & 0.924521 & 0.908856 & 0.870622 & 0.979297 \\ \hline
  \end{tabular}
  \caption{Statystki dla TimeSeriesForest z rÛønymi rozmiarami okien}
  \label{tab:tsf_performance}
  \end{table}
  \begin{figure}[hp!]
    \centering
    \includegraphics[width=12.3cm]{TSF.png}
    \vspace{-0.1cm}
    \caption{Krzywa uczenia dla TSF}
    \label{Krzywa uczenia dla TSF}
\end{figure}
\begin{figure}[hp!]
    \centering
    \includegraphics[width=12.3cm]{TSF2.png}
    \vspace{-0.1cm}
    \caption{Macierz pomy≥ek dla TSF}
    \label{Macierz pomy≥ek dla TSF}
\end{figure}
\begin{figure}[htbp!]
    \centering
    \includegraphics[width=12.3cm]{TSF3.png}
    \vspace{-0.1cm}
    \caption{Wykres AUROC dla TSF}
    \label{Wykres AUROC dla TSF}
\end{figure}

\newpage

\subsection{Eksperyment nr 2}
Wykorzystania algorytmÛw detekcji zmian w celu poznania ich dzia≥ania oraz lepszego poznania wybranych zbioru danych.
\subsubsection{Rezultat ADWIN}  
\begin{table}[htbp]
\centering
\begin{tabular}{|l|c|}
\hline
\textbf{Numer indeksu wykrycia zmiany} & \textbf{Na jakπ klasÍ} \\ \hline
Change detected at index 1695 & 1 \\ \hline
Change detected at index 2239 & 2 \\ \hline
Change detected at index 3711 & 3 \\ \hline
Change detected at index 3871 & 4 \\ \hline
\end{tabular}
\caption{Miejsce i klasa zmiany trendu}
\label{tab:ADWIN}
\end{table}
\subsubsection{Rezultat DDM}
Naleøy pamietaÊ øe algorytmy takie jak \textbf{DDM} i \textbf{EDDM} wykrywajπ tylko \textbf{binarnπ zmianÍ}, w tym przypadku musieliúmy wykorzystaÊ drugi zbiÛr danych. 
\begin{table}[htbp]
\centering
\begin{tabular}{|l|}
\hline
\textbf{Numer indeksu wykrycia zmiany} \\ \hline
Change detected at index 138 \\ \hline
Change detected at index 408 \\ \hline
Change detected at index 510 \\ \hline
Change detected at index 722 \\ \hline
\end{tabular}
\caption{Miejsce zmiany trendu}
\label{tab:DDM}
\end{table}
\newpage

\section{Wnioski}

Wnioski z przeprowadzonych eksperymentÛw dowodzπ, øe 

\begin{itemize}
    \item EfektywnoúÊ klasyfikatorÛw wykozystajπcych z miary DTW jest niøsza w przypadkach wiÍkszych zbiorÛw danych posiadajπcych wysokπ iloúÊ cech w zbiorze. 
    \item Utrudnione jest trenowanie klasyfikatorÛw wykorzystujπcych miarÍ DTW, poniewaø liczenie tej miary jest wymagajπcym zadaniem dla procesora przez swojπ z≥oøonπ implementacje wykorzystuje programowanie dynamiczne.
    \item EfektywnoúÊ klasyfikatora TimeSeriesForest jest porÛwnywalny do poprzednie badanych klasyfikatorÛw, co czyni go skutecznym narzÍdziem w analizie i klasyfikacji danych sekwencyjnych, pomimo duøej iloúci cech w zbiorze. Naleøy jednak pamiÍtaÊ o wybraniu w takim przypadku \textbf{wiÍkszego okna kontekstu}.
    \item Metody detekcji dryfu sπ w stanie z pewnπ pewnoúciπ okreúliÊ \textbf{concept drift}, w przypadku \textbf{ADWIN} wykorzystywane jest okno przesuwne, aby okreúliÊ ten moment.
    \item DDM jest skutecznπ metodπ wykrywania zmiany rozk≥adu danych.
    \item Metody detekcji concept drift umoøliwajπ lepiej poznaÊ zbiÛr danych strumieniowych oraz mogπ byÊ wykorzystywane jako triggery poszczegÛlnych operacji w przypadku zmiany trendu.   
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BIBLIOGRAFIA
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
